**테스트 로직 작성 경험 후기: 런던파와 고전파 비교**

현재 회사에서는 **런던파** 방식에 따라 Mock을 적극적으로 활용하여 테스트를 작성하고 있습니다. 하지만 이러한 접근 방식을 사용하면서 몇 가지 고민이 생겼습니다.

### 런던파 방식의 경험

Mock을 많이 사용하면 테스트가 **test fixture**(테스트 데이터나 환경 설정)에 지나치게 의존적이라는 느낌을 받았습니다.

- 예를 들어, 로직이 잘못 구현되었더라도 Mock 객체가 미리 정의된 test fixture를 반환한다면, 테스트가 실패하지 않을 수 있습니다.
- 이는 "정말 로직이 의도대로 동작하는가?"에 대한 신뢰성을 떨어뜨렸습니다. Mock을 과도하게 사용하면서 테스트가 코드의 실제 동작을 충분히 검증하지 못하는 듯한 느낌을 받았습니다.

### 예시:

서비스 레이어를 테스트할 때, Mock된 리포지토리 객체를 활용했습니다.

- 리포지토리 메서드 호출 시 미리 설정한 결과를 반환하도록 했는데, 결과적으로 DB의 동작과는 상관없는 상태에서 테스트가 성공했습니다.
- 이 때문에 로직의 오류를 발견하지 못하고, 실제 배포 환경에서 예외적인 문제를 경험한 적이 있습니다.

---

### 고전파 방식의 경험

Mock을 최소화하고 실제 객체들을 조합하여 테스트하는 **고전파 방식**도 시도해 보았습니다.

- 실제 객체들 간의 협력 과정을 통해 **신뢰성 있는 결과**를 도출할 수 있다는 장점이 있었습니다.
- 예를 들어, 컨트롤러에서부터 서비스, 리포지토리까지 실제 의존 객체를 사용해 테스트를 작성하니, 전체적인 흐름을 검증할 수 있었습니다.

하지만 **단점**도 명확했습니다.

1. **테스트 데이터 관리의 복잡성**
    - 테스트 데이터를 세팅하기 위해 각 테스트 클래스에서 **SQL 파일**을 작성하여 관리했습니다.
    - 문제는 SQL 파일을 여러 사람이 변경하면서 유지보수가 어렵다는 점이었습니다.
    - 특히, 테스트 데이터의 의도를 파악하려면 SQL 코드를 일일이 읽어야 했기에 효율성이 떨어졌습니다.
2. **테스트 속도**
    - 실제 데이터베이스와 통신하기 때문에 테스트 실행 시간이 늘어났습니다.
    - 테스트가 늘어날 수록 테스트의 실행 시간이 생산성에 영향이 미칠 수 있을것 이라고 생각이 들었습니다.
    - 또한 실제 환경을 세팅해야 하니 FAKE 객체를 만들거나 테스트 환경을 구축하는데 시간이 더 소요되었습니다.

---

### 결론

- **런던파 방식**은 테스트 작성 속도가 빠르고, 테스트 환경을 손쉽게 제어할 수 있지만, 과도한 Mock 사용은 테스트의 신뢰성을 떨어뜨릴 수 있다는 한계를 경험했습니다.
- 반대로, **고전파 방식**은 신뢰성이 높지만 데이터 관리와 실행 속도에서 비효율적인 측면이 있었습니다.

런던파 방식의 장점인 속도와 유연성에도 불구하고, **테스트의 신뢰성**이 무엇보다 중요하다는 점에서 **고전파 방식**을 선호하게 되었습니다.

- 고전파 방식은 실제 객체 간의 협력 과정을 검증하므로, 테스트의 **결과에 대한 확신**을 가질 수 있었습니다.
- 특히, 중요한 비즈니스 로직이나 다수의 객체 간 협력이 이루어지는 상황에서는 고전파 방식이 더 적합하다고 판단됩니다.

결국, 신뢰할 수 있는 테스트가 프로젝트의 품질을 보장하기에, **고전파 방식**을 기본으로 하여 테스트를 작성하는 것이 가장 이상적인 선택이라 생각합니다.